{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": true,
  "properties": {
    "replicaCount": {
      "type": "integer",
      "minimum": 1
    },
    "image": {
      "type": "object",
      "additionalProperties": true,
      "required": ["repository", "tag"],
      "properties": {
        "repository": {
          "type": "string",
          "minLength": 1,
          "description": "Image repository WITHOUT tag/digest (no ':' allowed). Example: ghcr.io/massimodanieli/circle-api",
          "not": {
            "pattern": ":"
          }
        },
        "tag": {
          "type": "string",
          "minLength": 1,
          "description": "Image tag ONLY (e.g. main or sha-<40hex>)",
          "anyOf": [
            { "pattern": "^[A-Za-z0-9][A-Za-z0-9_.-]{0,127}$" },
            { "pattern": "^sha-[0-9a-f]{40}$" }
          ]
        },
        "pullPolicy": {
          "type": "string",
          "enum": ["Always", "IfNotPresent", "Never"]
        }
      }
    }
  }
}
